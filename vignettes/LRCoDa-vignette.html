<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>LRCoDa-vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">LRCoDa-vignette</h1>



<div id="load-dependencies" class="section level2">
<h2>1. Load Dependencies</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LRCoDa)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robCompositions)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robustbase)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span></code></pre></div>
</div>
<div id="load-data" class="section level2">
<h2>2. Load data</h2>
<p>Load dataset “gemas” from the package <code>robCompositions</code>
and recode one level from “” to “Not Specified”, since the
<code>LRCoDa</code> function does not allow empty names for the
levels.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;gemas&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>gemas <span class="ot">&lt;-</span> gemas <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">soilclass =</span> <span class="fu">fct_recode</span>(soilclass, <span class="st">&quot;Not specified&quot;</span> <span class="ot">=</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
</div>
<div id="introduction-of-usage-of-the-factor-variable-extension-with-lrcoda" class="section level2">
<h2>3. Introduction of usage of the factor variable extension with
LRCoDa</h2>
<p>With the newly released package <code>LRCoDa</code> we are able to
use factor variables for the linear regression on raw compositional
data. As in the function <code>lmCoDaX</code> from the package
<code>robCompositions</code> we have the option between the “robust” and
“classical” method.</p>
<p>First, we show an example where we use the robust method on the
dataset “gemas” and use the “soilclass” as the factor variable, the
trace elements as composition and “sand” as the target variable.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(soilclass, Al<span class="sc">:</span>Zr))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> gemas<span class="sc">$</span>sand</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>LR_robust_1 <span class="ot">&lt;-</span> <span class="fu">LRCoDa</span>(<span class="at">y =</span> y, <span class="at">X =</span> X, <span class="at">factor_column =</span> <span class="st">&#39;soilclass&#39;</span>, <span class="at">method =</span> <span class="st">&#39;robust&#39;</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">max_refinement_steps =</span> <span class="dv">500</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>LR_robust_1<span class="sc">$</span>ilr</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -41.0838  -6.8577   0.1107   7.2740  41.9616 </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        -123.3818    13.7721  -8.959  &lt; 2e-16 ***</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassll   14.9186     0.9189  16.236  &lt; 2e-16 ***</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassm    -8.7900     0.6868 -12.798  &lt; 2e-16 ***</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclasss   -18.5752     0.8669 -21.427  &lt; 2e-16 ***</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassss  -33.2629     5.2739  -6.307 3.47e-10 ***</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al          14.8547     2.0378   7.290 4.41e-13 ***</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba           2.4205     1.2327   1.964 0.049709 *  </span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca          -1.0235     0.4290  -2.386 0.017125 *  </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr          -5.1071     0.7511  -6.799 1.37e-11 ***</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe           1.0858     1.4232   0.763 0.445598    </span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K          -11.1702     1.7114  -6.527 8.42e-11 ***</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg           3.0773     1.0621   2.897 0.003801 ** </span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn          -0.8890     0.6126  -1.451 0.146894    </span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na          -4.6022     0.4920  -9.354  &lt; 2e-16 ***</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb           0.7382     1.5341   0.481 0.630415    </span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P            1.2243     0.7950   1.540 0.123692    </span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si          21.1046     1.0338  20.414  &lt; 2e-16 ***</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr           1.5964     0.8627   1.850 0.064393 .  </span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti          -7.6404     2.0201  -3.782 0.000160 ***</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V           -4.2720     1.2856  -3.323 0.000906 ***</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y           -6.6511     1.4604  -4.554 5.56e-06 ***</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn           2.4713     0.8799   2.809 0.005023 ** </span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr          -7.2178     1.2151  -5.940 3.33e-09 ***</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robust residual standard error: 10.21 </span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7143, Adjusted R-squared:  0.7114 </span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Convergence in 18 IRWLS iterations</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robustness weights: </span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 observations c(272,1491,1522) are outliers with |weight| = 0 ( &lt; 4.8e-05); </span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  182 weights are ~= 1. The remaining 1898 ones are summarized as</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.01991 0.86540 0.94990 0.89810 0.98420 0.99900 </span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algorithmic parameters: </span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tuning.chi                bb        tuning.psi        refine.tol           rel.tol         scale.tol         solve.tol </span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1.548e+00         5.000e-01         4.685e+00         1.000e-07         1.000e-07         1.000e-10         1.000e-07 </span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       eps.outlier             eps.x warn.limit.reject warn.limit.meanrw </span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         4.801e-05         8.205e-07         5.000e-01         5.000e-01 </span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   nResample      max.it    best.r.s    k.fast.s       k.max maxit.scale   trace.lev         mts  compute.rd </span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         500          50           2           1         500         200           0        1000           0 </span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   psi           subsampling                   cov compute.outlier.stats </span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &quot;bisquare&quot;         &quot;nonsingular&quot;         &quot;.vcov.avar1&quot;                  &quot;SM&quot; </span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; seed : int(0)</span></span></code></pre></div>
<p>We can access the summary output of the Linear Regression as known
from the function <code>lmCoDaX</code> with $ilr (for the ilr output)
and $lm (for the lm output). Furthermore, we can also clearly identify
through the prefix of the variables which is the factor variable and
which are the variables from the composition.</p>
<p>The output for the robust method looks differently to the output from
the <code>lmCoDaX</code> function, since we use <code>lmrob</code> for
the robust calculation of the linear regression in <code>LRCoDa</code>
instead of <code>ltsReg</code> in <code>lmCoDaX</code>.</p>
<div id="limitations-of-the-factor-variable-usage" class="section level3">
<h3>3.1. Limitations of the factor variable usage</h3>
<p>We list a few scenarios in which we illustrate the limitations of the
factor variable usage.</p>
<div id="more-than-one-factor-variable-is-not-allowed" class="section level4">
<h4>3.1.1. More than one factor variable is not allowed</h4>
<p>We only can use one factor variable for the model. We return an error
message when more than one factor variable is used.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(soilclass, COUNTRY, Al<span class="sc">:</span>Zr))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">factor_column =</span> <span class="fu">c</span>(<span class="st">&#39;COUNTRY&#39;</span>, <span class="st">&#39;soilclass&#39;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in LRCoDa(y = gemas$sand, X = X, factor_column = c(&quot;COUNTRY&quot;, &quot;soilclass&quot;)): There are more than 1 factor variable defined</span></span></code></pre></div>
</div>
<div id="only-characters-and-factors-are-allowed-as-datatype-for-the-factor-variable" class="section level4">
<h4>3.1.2. Only characters and factors are allowed as datatype for the
factor variable</h4>
<p>We only allow character and factor as datatypes for the factor
variable for the model. We return an error message when a numerical
values are contained in the factor variable.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(MeanTemp, Al<span class="sc">:</span>Zr))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">factor_column =</span> <span class="fu">c</span>(<span class="st">&#39;MeanTemp&#39;</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in LRCoDa(y = gemas$sand, X = X, factor_column = c(&quot;MeanTemp&quot;)): Datatype of &#39;factor_column&#39; has to be factor or character</span></span></code></pre></div>
</div>
<div id="the-factor-has-to-be-specified" class="section level4">
<h4>3.1.3. The factor has to be specified</h4>
<p>When the factor column is not specified in the function input, but X
contains a variable with factors or characters the function returns an
error message that “X contains non-numerical variables but there is no
factor_column defined”.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(soilclass, Al<span class="sc">:</span>Zr))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in LRCoDa(y = gemas$sand, X = X): X contains non-numerical variables but there is no factor_column defined</span></span></code></pre></div>
</div>
<div id="factor-column-has-to-be-specified-as-name-in-the-function-input" class="section level4">
<h4>3.1.4. Factor column has to be specified as name in the function
input</h4>
<p>The factor column has to be specified exactly like in the help
function described. It is not possible to fill in the whole column.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(soilclass, Al<span class="sc">:</span>Zr))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">factor_column =</span> X <span class="sc">%&gt;%</span> <span class="fu">select</span>(soilclass))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in LRCoDa(y = gemas$sand, X = X, factor_column = X %&gt;% select(soilclass)): Invalid datatype for factor_column</span></span></code></pre></div>
</div>
</div>
</div>
<div id="introduction-of-usage-of-the-external-variable-extension-with-lrcoda" class="section level2">
<h2>4. Introduction of usage of the external variable extension with
LRCoDa</h2>
<p>With the newly released package <code>LRCoDa</code> we are also able
to use external variables, which are not part of the composition. We
have here also the option between the “robust” and “classical” method
and we can combine it with a factor variable.</p>
<p>We show an example where we combine external variables with a factor
variables and of course the composition (naming as internal variables).
We use the “gemas” dataset, where “MeanTemp” the external variable is,
“soilclass” the factor variable, the trace elements the composition
(“Internal” variables) and “sand” the target variable.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(MeanTemp, soilclass, Al<span class="sc">:</span>Zr))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> gemas<span class="sc">$</span>sand</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>LR_robust_2 <span class="ot">&lt;-</span> <span class="fu">LRCoDa</span>(<span class="at">y =</span> y, <span class="at">X =</span> X, <span class="at">external =</span> <span class="fu">c</span>(<span class="st">&#39;MeanTemp&#39;</span>), <span class="at">factor_column =</span> <span class="st">&#39;soilclass&#39;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">method =</span> <span class="st">&#39;robust&#39;</span>, <span class="at">max_refinement_steps =</span> <span class="dv">500</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>LR_robust_2<span class="sc">$</span>ilr</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -41.1571  -6.8634   0.1324   6.9206  42.9100 </span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        -125.64562   13.77878  -9.119  &lt; 2e-16 ***</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassll   15.93159    0.90766  17.552  &lt; 2e-16 ***</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassm    -9.41555    0.68006 -13.845  &lt; 2e-16 ***</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclasss   -19.95837    0.86944 -22.955  &lt; 2e-16 ***</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassss  -35.77658    4.44453  -8.050 1.39e-15 ***</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.MeanTemp     0.64842    0.08010   8.095 9.67e-16 ***</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al          11.83619    2.08708   5.671 1.62e-08 ***</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba           3.60807    1.16387   3.100 0.001961 ** </span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca          -1.06874    0.43090  -2.480 0.013208 *  </span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr          -5.64672    0.73485  -7.684 2.37e-14 ***</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe           2.34590    1.39600   1.680 0.093022 .  </span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K          -10.59626    1.62954  -6.503 9.88e-11 ***</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg           3.47490    1.00399   3.461 0.000549 ***</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn          -0.97684    0.60813  -1.606 0.108361    </span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na          -3.39515    0.50899  -6.670 3.27e-11 ***</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb           0.03211    1.47981   0.022 0.982691    </span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P            1.99485    0.77882   2.561 0.010496 *  </span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si          20.12056    1.01394  19.844  &lt; 2e-16 ***</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr           1.20002    0.85742   1.400 0.161792    </span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti          -7.44338    1.94382  -3.829 0.000132 ***</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V           -3.52600    1.25319  -2.814 0.004945 ** </span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y           -7.33968    1.45242  -5.053 4.72e-07 ***</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn           1.70501    0.87972   1.938 0.052744 .  </span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr          -6.32494    1.16815  -5.415 6.86e-08 ***</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robust residual standard error: 10.03 </span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.724,  Adjusted R-squared:  0.7211 </span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Convergence in 30 IRWLS iterations</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robustness weights: </span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 observations c(272,1491,1522) are outliers with |weight| = 0 ( &lt; 4.8e-05); </span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  182 weights are ~= 1. The remaining 1898 ones are summarized as</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.01252 0.85860 0.95180 0.89790 0.98510 0.99900 </span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algorithmic parameters: </span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tuning.chi                bb        tuning.psi        refine.tol           rel.tol         scale.tol         solve.tol </span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1.548e+00         5.000e-01         4.685e+00         1.000e-07         1.000e-07         1.000e-10         1.000e-07 </span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       eps.outlier             eps.x warn.limit.reject warn.limit.meanrw </span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         4.801e-05         8.205e-07         5.000e-01         5.000e-01 </span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   nResample      max.it    best.r.s    k.fast.s       k.max maxit.scale   trace.lev         mts  compute.rd </span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         500          50           2           1         500         200           0        1000           0 </span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   psi           subsampling                   cov compute.outlier.stats </span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &quot;bisquare&quot;         &quot;nonsingular&quot;         &quot;.vcov.avar1&quot;                  &quot;SM&quot; </span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; seed : int(0)</span></span></code></pre></div>
<p>We can observe here that all the different types of variable have the
different prefix, where we can identify them without any problem.</p>
<div id="possibilities-and-limitations-of-the-external-variable-usage" class="section level3">
<h3>4.1 Possibilities and Limitations of the external variable
usage</h3>
<p>We list the possibilities and the limitations of the external
variable usage.</p>
<div id="multiple-external-variables-are-allowed-and-supported" class="section level4">
<h4>4.1.1. Multiple external variables are allowed and supported</h4>
<p>We allow and support the usage of multiple external variables in the
same model.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(MeanTemp, AnnPrec, Al<span class="sc">:</span>Zr))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">external =</span> <span class="fu">c</span>(<span class="st">&#39;MeanTemp&#39;</span>, <span class="st">&#39;AnnPrec&#39;</span>), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">method =</span> <span class="st">&quot;classical&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = ZV)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       (Intercept)  External.MeanTemp   External.AnnPrec        Internal.Al        Internal.Ba        Internal.Ca        Internal.Cr  </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         4.815e+01         -8.034e-03          9.071e-03         -5.359e-05          7.987e-03         -2.223e-05         -1.690e-02  </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Internal.Fe         Internal.K        Internal.Mg        Internal.Mn        Internal.Na        Internal.Nb         Internal.P  </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         2.656e-04         -5.797e-04          5.203e-05         -1.277e-03          4.519e-04          3.295e-01          4.639e-03  </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Internal.Si        Internal.Sr        Internal.Ti         Internal.V         Internal.Y        Internal.Zn        Internal.Zr  </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         8.932e-05         -1.926e-03         -1.744e-03         -1.210e-01         -4.445e-01         -7.199e-03         -4.502e-02  </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = ZV)</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -49.692  -9.997  -0.469   9.377  85.440 </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        4.815e+01  4.197e+00  11.472  &lt; 2e-16 ***</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.MeanTemp -8.034e-03  9.916e-02  -0.081 0.935435    </span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.AnnPrec   9.071e-03  1.349e-03   6.726 2.25e-11 ***</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al       -5.359e-05  4.714e-05  -1.137 0.255697    </span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba        7.987e-03  2.210e-03   3.614 0.000308 ***</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca       -2.223e-05  1.376e-05  -1.615 0.106447    </span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr       -1.690e-02  2.775e-03  -6.091 1.33e-09 ***</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe        2.656e-04  6.755e-05   3.933 8.68e-05 ***</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K        -5.797e-04  8.201e-05  -7.069 2.13e-12 ***</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg        5.203e-05  6.119e-05   0.850 0.395247    </span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn       -1.277e-03  6.214e-04  -2.054 0.040063 *  </span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na        4.519e-04  7.925e-05   5.702 1.35e-08 ***</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb        3.295e-01  6.885e-02   4.786 1.83e-06 ***</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P         4.639e-03  7.704e-04   6.021 2.05e-09 ***</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si        8.932e-05  9.686e-06   9.222  &lt; 2e-16 ***</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr       -1.926e-03  2.418e-03  -0.796 0.425908    </span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti       -1.744e-03  3.984e-04  -4.377 1.26e-05 ***</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V        -1.210e-01  2.066e-02  -5.855 5.54e-09 ***</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y        -4.445e-01  4.978e-02  -8.929  &lt; 2e-16 ***</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn       -7.199e-03  7.351e-03  -0.979 0.327572    </span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr       -4.502e-02  3.779e-03 -11.914  &lt; 2e-16 ***</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.11 on 2062 degrees of freedom</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4757, Adjusted R-squared:  0.4706 </span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 93.54 on 20 and 2062 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ilr</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = ZV)</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -47.650  -8.884  -0.257   8.451  63.567 </span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       -2.313e+02  1.423e+01 -16.251  &lt; 2e-16 ***</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.MeanTemp -1.525e-02  8.723e-02  -0.175 0.861233    </span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.AnnPrec   7.454e-03  1.255e-03   5.941 3.31e-09 ***</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al        1.702e+01  2.145e+00   7.933 3.46e-15 ***</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba        4.716e+00  1.285e+00   3.669 0.000249 ***</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca       -2.004e+00  4.724e-01  -4.242 2.31e-05 ***</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr       -8.533e+00  7.029e-01 -12.140  &lt; 2e-16 ***</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe        6.044e+00  1.607e+00   3.762 0.000174 ***</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K        -1.908e+01  1.443e+00 -13.220  &lt; 2e-16 ***</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg        3.071e+00  8.342e-01   3.682 0.000238 ***</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn       -1.768e+00  7.227e-01  -2.447 0.014490 *  </span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na       -2.064e+00  5.404e-01  -3.820 0.000138 ***</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb       -1.363e+00  1.325e+00  -1.028 0.303855    </span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P         7.557e+00  7.615e-01   9.923  &lt; 2e-16 ***</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si        2.973e+01  9.613e-01  30.925  &lt; 2e-16 ***</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr        2.388e+00  8.618e-01   2.771 0.005641 ** </span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti       -1.062e+01  1.913e+00  -5.554 3.16e-08 ***</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V        -5.103e+00  1.526e+00  -3.343 0.000842 ***</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y        -1.407e+01  1.374e+00 -10.241  &lt; 2e-16 ***</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn       -1.721e+00  9.196e-01  -1.871 0.061492 .  </span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr       -4.192e+00  1.254e+00  -3.343 0.000845 ***</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 12.84 on 2062 degrees of freedom</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.5656, Adjusted R-squared:  0.5616 </span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 141.4 on 19 and 2063 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div id="only-numerical-variables-are-allowed-as-external-variables" class="section level4">
<h4>4.1.2. Only numerical variables are allowed as External
variables</h4>
<p>We allow only numerical variables for the external variables, since
non-numerical variables are captured with the factor variables. We
return an error message that “X contains non-numerical variables but
there is no factor_column defined”.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(MeanTemp, AnnPrec, COUNTRY, Al<span class="sc">:</span>Zr))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">external =</span> <span class="fu">c</span>(<span class="st">&#39;MeanTemp&#39;</span>, <span class="st">&#39;AnnPrec&#39;</span>, <span class="st">&#39;COUNTRY&#39;</span>), </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">method =</span> <span class="st">&#39;classical&#39;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in LRCoDa(y = gemas$sand, X = X, external = c(&quot;MeanTemp&quot;, &quot;AnnPrec&quot;, : X contains non-numerical variables but there is no factor_column defined</span></span></code></pre></div>
</div>
<div id="external-column-has-to-be-specified-as-name-in-the-function-input" class="section level4">
<h4>4.1.3. External column has to be specified as name in the function
input</h4>
<p>The external column has to be specified exactly like in the help
function described. It is not possible to fill in the whole column.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(MeanTemp, AnnPrec, Al<span class="sc">:</span>Zr))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">external =</span> X <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&#39;MeanTemp&#39;</span>, <span class="st">&#39;AnnPrec&#39;</span>)))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in LRCoDa(y = gemas$sand, X = X, external = X %&gt;% select(c(&quot;MeanTemp&quot;, : Invalid datatype for external</span></span></code></pre></div>
</div>
</div>
</div>
<div id="use-of-lmrob-for-robust-fitting" class="section level2">
<h2>5. Use of lmrob for robust fitting</h2>
<p>With the newly introduced factor variable usage for the linear
regression on raw compositional data, we have to change the fitting
algorithm from the old <code>ltsReg</code> (used in
<code>lmCoDaX</code>) to <code>lmrob</code> (used in
<code>LRCoDa</code>). This change offers a lot of advantages when
working with factor variables and also with external variables in
comparison to <code>ltsReg</code> which is very limited for this
application. Furthermore, <code>lmrob</code> determines robustness
weights between 0 and 1, whereas <code>ltsReg</code> works only with 0
and 1 for the robustness weigths. However, there are also new challenges
introduced with <code>lmrob</code>, as illustrated in the example below.
Also the backwards compatibility of the function when fitting with the
robust method is not given because of this change.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(MeanTemp, AnnPrec, soilclass, Al<span class="sc">:</span>Zr))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">external =</span> <span class="fu">c</span>(<span class="st">&#39;MeanTemp&#39;</span>, <span class="st">&#39;AnnPrec&#39;</span>), </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">factor_column =</span> <span class="fu">c</span>(<span class="st">&#39;soilclass&#39;</span>), <span class="at">max_refinement_steps =</span> <span class="dv">200</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in lmrob.S(x, y, control = control): S refinements did not converge (to refine.tol=1e-07) in 200 (= k.max) steps</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in lmrob.S(x, y, control = control): S refinements did not converge (to refine.tol=1e-07) in 200 (= k.max) steps</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (Intercept)  Factor.soilclassll   Factor.soilclassm   Factor.soilclasss  Factor.soilclassss   External.MeanTemp  </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          3.136e+01           1.840e+01          -1.098e+01          -2.183e+01          -3.728e+01           6.448e-01  </span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   External.AnnPrec         Internal.Al         Internal.Ba         Internal.Ca         Internal.Cr         Internal.Fe  </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          1.899e-03           1.055e-04           6.898e-03           4.579e-05          -1.841e-02           8.053e-05  </span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Internal.K         Internal.Mg         Internal.Mn         Internal.Na         Internal.Nb          Internal.P  </span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -2.589e-04           2.067e-04          -4.378e-04          -1.946e-04           2.374e-01           1.952e-03  </span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Internal.Si         Internal.Sr         Internal.Ti          Internal.V          Internal.Y         Internal.Zn  </span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          9.782e-05          -1.479e-03          -6.630e-04          -7.412e-02          -1.130e-01          -5.154e-03  </span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Internal.Zr  </span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -5.004e-02  </span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -44.1529  -6.8495   0.1405   6.6386  62.8416 </span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)         3.136e+01  2.973e+00  10.548  &lt; 2e-16 ***</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassll  1.840e+01  8.882e-01  20.718  &lt; 2e-16 ***</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassm  -1.098e+01  7.019e-01 -15.636  &lt; 2e-16 ***</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclasss  -2.183e+01  9.340e-01 -23.375  &lt; 2e-16 ***</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassss -3.728e+01  3.189e+00 -11.693  &lt; 2e-16 ***</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.MeanTemp   6.448e-01  9.399e-02   6.860 9.10e-12 ***</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.AnnPrec    1.899e-03  1.003e-03   1.894 0.058403 .  </span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al         1.055e-04  4.440e-05   2.375 0.017630 *  </span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba         6.898e-03  1.589e-03   4.340 1.49e-05 ***</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca         4.579e-05  1.003e-05   4.564 5.32e-06 ***</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr        -1.841e-02  7.310e-03  -2.518 0.011871 *  </span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe         8.053e-05  5.301e-05   1.519 0.128904    </span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K         -2.589e-04  9.334e-05  -2.774 0.005586 ** </span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg         2.067e-04  8.155e-05   2.534 0.011344 *  </span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn        -4.378e-04  4.695e-04  -0.932 0.351232    </span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na        -1.946e-04  7.051e-05  -2.759 0.005842 ** </span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb         2.374e-01  7.390e-02   3.213 0.001335 ** </span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P          1.952e-03  6.733e-04   2.898 0.003791 ** </span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si         9.782e-05  6.392e-06  15.304  &lt; 2e-16 ***</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr        -1.479e-03  3.374e-03  -0.438 0.661162    </span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti        -6.630e-04  5.141e-04  -1.290 0.197328    </span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V         -7.412e-02  2.043e-02  -3.627 0.000294 ***</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y         -1.130e-01  4.773e-02  -2.368 0.017990 *  </span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn        -5.154e-03  5.684e-03  -0.907 0.364610    </span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr        -5.004e-02  3.717e-03 -13.464  &lt; 2e-16 ***</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robust residual standard error: 9.995 </span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7225, Adjusted R-squared:  0.7193 </span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Convergence in 26 IRWLS iterations</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robustness weights: </span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 observations c(272,1491,1522) are outliers with |weight| = 0 ( &lt; 4.8e-05); </span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  173 weights are ~= 1. The remaining 1907 ones are summarized as</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.0123  0.8594  0.9518  0.8979  0.9850  0.9990 </span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algorithmic parameters: </span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tuning.chi                bb        tuning.psi        refine.tol           rel.tol         scale.tol         solve.tol </span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1.548e+00         5.000e-01         4.685e+00         1.000e-07         1.000e-07         1.000e-10         1.000e-07 </span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       eps.outlier             eps.x warn.limit.reject warn.limit.meanrw </span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         4.801e-05         8.205e-07         5.000e-01         5.000e-01 </span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   nResample      max.it    best.r.s    k.fast.s       k.max maxit.scale   trace.lev         mts  compute.rd </span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         500          50           2           1         200         200           0        1000           0 </span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   psi           subsampling                   cov compute.outlier.stats </span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &quot;bisquare&quot;         &quot;nonsingular&quot;         &quot;.vcov.avar1&quot;                  &quot;SM&quot; </span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; seed : int(0) </span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ilr</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -41.0566  -6.8168   0.1723   6.9340  43.4220 </span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        -1.300e+02  1.393e+01  -9.327  &lt; 2e-16 ***</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassll  1.576e+01  9.064e-01  17.390  &lt; 2e-16 ***</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassm  -9.273e+00  6.803e-01 -13.631  &lt; 2e-16 ***</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclasss  -1.966e+01  8.769e-01 -22.419  &lt; 2e-16 ***</span></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassss -3.568e+01  4.405e+00  -8.098 9.47e-16 ***</span></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.MeanTemp   6.257e-01  8.072e-02   7.751 1.42e-14 ***</span></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.AnnPrec    2.615e-03  1.036e-03   2.524 0.011689 *  </span></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al         1.136e+01  2.101e+00   5.407 7.15e-08 ***</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba         3.948e+00  1.159e+00   3.405 0.000674 ***</span></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca        -9.073e-01  4.353e-01  -2.084 0.037275 *  </span></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr        -5.655e+00  7.287e-01  -7.760 1.32e-14 ***</span></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe         2.721e+00  1.401e+00   1.942 0.052268 .  </span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K         -1.039e+01  1.630e+00  -6.375 2.26e-10 ***</span></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg         3.451e+00  9.944e-01   3.471 0.000530 ***</span></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn        -1.057e+00  6.089e-01  -1.736 0.082672 .  </span></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na        -3.649e+00         NA      NA       NA    </span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb         7.393e-02  1.482e+00   0.050 0.960215    </span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P          1.598e+00  7.919e-01   2.018 0.043761 *  </span></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si         2.053e+01  1.025e+00  20.027  &lt; 2e-16 ***</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr         3.178e+00         NA      NA       NA    </span></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti        -7.681e+00  1.921e+00  -3.998 6.61e-05 ***</span></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V         -3.522e+00  1.257e+00  -2.802 0.005124 ** </span></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y         -7.405e+00  1.452e+00  -5.101 3.70e-07 ***</span></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn         1.536e+00  8.658e-01   1.774 0.076232 .  </span></span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr        -6.295e+00  1.170e+00  -5.380 8.28e-08 ***</span></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robust residual standard error: 9.995 </span></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7253, Adjusted R-squared:  0.7223 </span></span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Convergence in 26 IRWLS iterations</span></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robustness weights: </span></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 observations c(272,1491,1522) are outliers with |weight| = 0 ( &lt; 4.8e-05); </span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  173 weights are ~= 1. The remaining 1907 ones are summarized as</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.0123  0.8594  0.9518  0.8979  0.9850  0.9990 </span></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algorithmic parameters: </span></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tuning.chi                bb        tuning.psi        refine.tol           rel.tol         scale.tol         solve.tol </span></span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1.548e+00         5.000e-01         4.685e+00         1.000e-07         1.000e-07         1.000e-10         1.000e-07 </span></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       eps.outlier             eps.x warn.limit.reject warn.limit.meanrw </span></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         4.801e-05         8.205e-07         5.000e-01         5.000e-01 </span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   nResample      max.it    best.r.s    k.fast.s       k.max maxit.scale   trace.lev         mts  compute.rd </span></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         500          50           2           1         200         200           0        1000           0 </span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   psi           subsampling                   cov compute.outlier.stats </span></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &quot;bisquare&quot;         &quot;nonsingular&quot;         &quot;.vcov.avar1&quot;                  &quot;SM&quot; </span></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; seed : int(0)</span></span></code></pre></div>
<p>The algorithm does not converge with the default refinement steps 200
as defined in the <code>lmrob</code> function. Therefore we added the
max_refinement_steps parameter directly in the function input in
<code>LRCoDa</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(MeanTemp, AnnPrec, soilclass, Al<span class="sc">:</span>Zr))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">external =</span> <span class="fu">c</span>(<span class="st">&#39;MeanTemp&#39;</span>, <span class="st">&#39;AnnPrec&#39;</span>), </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">factor_column =</span> <span class="fu">c</span>(<span class="st">&#39;soilclass&#39;</span>), <span class="at">max_refinement_steps =</span> <span class="dv">500</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (Intercept)  Factor.soilclassll   Factor.soilclassm   Factor.soilclasss  Factor.soilclassss   External.MeanTemp  </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          3.136e+01           1.840e+01          -1.098e+01          -2.183e+01          -3.728e+01           6.448e-01  </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   External.AnnPrec         Internal.Al         Internal.Ba         Internal.Ca         Internal.Cr         Internal.Fe  </span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          1.899e-03           1.055e-04           6.898e-03           4.578e-05          -1.840e-02           8.053e-05  </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Internal.K         Internal.Mg         Internal.Mn         Internal.Na         Internal.Nb          Internal.P  </span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -2.589e-04           2.067e-04          -4.378e-04          -1.946e-04           2.374e-01           1.951e-03  </span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Internal.Si         Internal.Sr         Internal.Ti          Internal.V          Internal.Y         Internal.Zn  </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          9.781e-05          -1.479e-03          -6.629e-04          -7.412e-02          -1.130e-01          -5.155e-03  </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Internal.Zr  </span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -5.004e-02  </span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -44.1525  -6.8495   0.1409   6.6386  62.8314 </span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)         3.136e+01  2.977e+00  10.535  &lt; 2e-16 ***</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassll  1.840e+01  8.884e-01  20.713  &lt; 2e-16 ***</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassm  -1.098e+01  7.020e-01 -15.634  &lt; 2e-16 ***</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclasss  -2.183e+01  9.337e-01 -23.383  &lt; 2e-16 ***</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassss -3.728e+01  3.187e+00 -11.697  &lt; 2e-16 ***</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.MeanTemp   6.448e-01  9.399e-02   6.860 9.07e-12 ***</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.AnnPrec    1.899e-03  1.003e-03   1.894 0.058340 .  </span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al         1.055e-04  4.440e-05   2.375 0.017620 *  </span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba         6.898e-03  1.589e-03   4.340 1.49e-05 ***</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca         4.578e-05  1.003e-05   4.565 5.30e-06 ***</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr        -1.840e-02  7.311e-03  -2.518 0.011894 *  </span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe         8.053e-05  5.302e-05   1.519 0.128910    </span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K         -2.589e-04  9.332e-05  -2.775 0.005577 ** </span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg         2.067e-04  8.155e-05   2.534 0.011345 *  </span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn        -4.378e-04  4.695e-04  -0.932 0.351265    </span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na        -1.946e-04  7.057e-05  -2.757 0.005884 ** </span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb         2.374e-01  7.397e-02   3.209 0.001351 ** </span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P          1.951e-03  6.735e-04   2.898 0.003800 ** </span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si         9.781e-05  6.408e-06  15.264  &lt; 2e-16 ***</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr        -1.479e-03  3.373e-03  -0.438 0.661074    </span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti        -6.629e-04  5.141e-04  -1.290 0.197320    </span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V         -7.412e-02  2.045e-02  -3.625 0.000296 ***</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y         -1.130e-01  4.773e-02  -2.368 0.017985 *  </span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn        -5.155e-03  5.684e-03  -0.907 0.364627    </span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr        -5.004e-02  3.719e-03 -13.456  &lt; 2e-16 ***</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robust residual standard error: 9.996 </span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7225, Adjusted R-squared:  0.7192 </span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Convergence in 26 IRWLS iterations</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robustness weights: </span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 observations c(272,1491,1522) are outliers with |weight| = 0 ( &lt; 4.8e-05); </span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  174 weights are ~= 1. The remaining 1906 ones are summarized as</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.01237 0.85940 0.95180 0.89790 0.98500 0.99900 </span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algorithmic parameters: </span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tuning.chi                bb        tuning.psi        refine.tol           rel.tol         scale.tol         solve.tol </span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1.548e+00         5.000e-01         4.685e+00         1.000e-07         1.000e-07         1.000e-10         1.000e-07 </span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       eps.outlier             eps.x warn.limit.reject warn.limit.meanrw </span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         4.801e-05         8.205e-07         5.000e-01         5.000e-01 </span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   nResample      max.it    best.r.s    k.fast.s       k.max maxit.scale   trace.lev         mts  compute.rd </span></span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         500          50           2           1         500         200           0        1000           0 </span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   psi           subsampling                   cov compute.outlier.stats </span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &quot;bisquare&quot;         &quot;nonsingular&quot;         &quot;.vcov.avar1&quot;                  &quot;SM&quot; </span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; seed : int(0) </span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ilr</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; robustbase::lmrob(formula = y ~ ., data = ZV, control = cont_lmrob)</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  \--&gt; method = &quot;MM&quot;</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -41.0566  -6.8168   0.1723   6.9340  43.4220 </span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        -1.300e+02  1.393e+01  -9.327  &lt; 2e-16 ***</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassll  1.576e+01  9.064e-01  17.390  &lt; 2e-16 ***</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassm  -9.273e+00  6.803e-01 -13.631  &lt; 2e-16 ***</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclasss  -1.966e+01  8.769e-01 -22.419  &lt; 2e-16 ***</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Factor.soilclassss -3.568e+01  4.405e+00  -8.098 9.47e-16 ***</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.MeanTemp   6.257e-01  8.072e-02   7.751 1.42e-14 ***</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; External.AnnPrec    2.615e-03  1.036e-03   2.524 0.011689 *  </span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al         1.136e+01  2.101e+00   5.407 7.15e-08 ***</span></span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba         3.948e+00  1.159e+00   3.405 0.000674 ***</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca        -9.073e-01  4.353e-01  -2.084 0.037275 *  </span></span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr        -5.655e+00  7.287e-01  -7.760 1.32e-14 ***</span></span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe         2.721e+00  1.401e+00   1.942 0.052268 .  </span></span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K         -1.039e+01  1.630e+00  -6.375 2.26e-10 ***</span></span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg         3.451e+00  9.944e-01   3.471 0.000530 ***</span></span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn        -1.057e+00  6.089e-01  -1.736 0.082672 .  </span></span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na        -3.445e+00  5.085e-01  -6.775 1.62e-11 ***</span></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb         7.393e-02  1.482e+00   0.050 0.960215    </span></span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P          1.598e+00  7.919e-01   2.018 0.043761 *  </span></span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si         2.053e+01  1.025e+00  20.027  &lt; 2e-16 ***</span></span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr         1.138e+00  8.573e-01   1.327 0.184582    </span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti        -7.681e+00  1.921e+00  -3.998 6.61e-05 ***</span></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V         -3.522e+00  1.257e+00  -2.802 0.005124 ** </span></span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y         -7.405e+00  1.452e+00  -5.101 3.70e-07 ***</span></span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn         1.536e+00  8.658e-01   1.774 0.076232 .  </span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr        -6.295e+00  1.170e+00  -5.380 8.28e-08 ***</span></span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robust residual standard error: 9.996 </span></span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7253, Adjusted R-squared:  0.7223 </span></span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Convergence in 26 IRWLS iterations</span></span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Robustness weights: </span></span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 observations c(272,1491,1522) are outliers with |weight| = 0 ( &lt; 4.8e-05); </span></span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  174 weights are ~= 1. The remaining 1906 ones are summarized as</span></span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.01237 0.85940 0.95180 0.89790 0.98500 0.99900 </span></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Algorithmic parameters: </span></span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        tuning.chi                bb        tuning.psi        refine.tol           rel.tol         scale.tol         solve.tol </span></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         1.548e+00         5.000e-01         4.685e+00         1.000e-07         1.000e-07         1.000e-10         1.000e-07 </span></span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       eps.outlier             eps.x warn.limit.reject warn.limit.meanrw </span></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         4.801e-05         8.205e-07         5.000e-01         5.000e-01 </span></span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   nResample      max.it    best.r.s    k.fast.s       k.max maxit.scale   trace.lev         mts  compute.rd </span></span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         500          50           2           1         500         200           0        1000           0 </span></span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   psi           subsampling                   cov compute.outlier.stats </span></span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            &quot;bisquare&quot;         &quot;nonsingular&quot;         &quot;.vcov.avar1&quot;                  &quot;SM&quot; </span></span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; seed : int(0)</span></span></code></pre></div>
<p>And now with max_refinement_steps set to 500 the algorithm
converge.</p>
</div>
<div id="further-improvements" class="section level2">
<h2>6. Further improvements</h2>
<p>The norm of the pivot coordinates calculation can now also be defined
in the function input, in contrast to the <code>lmCoDaX</code> function.
The default value is “orthonorm” as it is the default in the
<code>pivotCoord</code> function and therefore used in
<code>lmCoDaX</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(gemas, <span class="fu">c</span>(Al<span class="sc">:</span>Zr))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LRCoDa</span>(<span class="at">y =</span> gemas<span class="sc">$</span>sand, <span class="at">X =</span> X, <span class="at">pivot_norm =</span> <span class="st">&quot;orthogonal&quot;</span>, <span class="at">method =</span> <span class="st">&quot;classical&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = ZV)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  Internal.Al  Internal.Ba  Internal.Ca  Internal.Cr  Internal.Fe   Internal.K  Internal.Mg  Internal.Mn  Internal.Na  </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   5.382e+01   -1.071e-05    7.017e-03   -3.097e-05   -1.655e-02    2.030e-04   -6.434e-04    6.020e-05   -9.576e-04    4.352e-04  </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb   Internal.P  Internal.Si  Internal.Sr  Internal.Ti   Internal.V   Internal.Y  Internal.Zn  Internal.Zr  </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   3.167e-01    6.232e-03    8.834e-05   -1.504e-03   -1.600e-03   -1.185e-01   -4.410e-01   -6.085e-03   -4.571e-02  </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $lm</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = ZV)</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -50.355 -10.011  -0.379   9.559  86.557 </span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  5.382e+01  4.153e+00  12.959  &lt; 2e-16 ***</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al -1.071e-05  4.549e-05  -0.235  0.81392    </span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba  7.017e-03  2.226e-03   3.153  0.00164 ** </span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca -3.097e-05  1.311e-05  -2.362  0.01826 *  </span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr -1.655e-02  2.751e-03  -6.017 2.10e-09 ***</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe  2.030e-04  6.732e-05   3.016  0.00259 ** </span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K  -6.434e-04  8.229e-05  -7.819 8.44e-15 ***</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg  6.020e-05  6.182e-05   0.974  0.33026    </span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn -9.576e-04  6.259e-04  -1.530  0.12619    </span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na  4.352e-04  7.072e-05   6.153 9.09e-10 ***</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb  3.167e-01  6.947e-02   4.559 5.45e-06 ***</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P   6.232e-03  7.365e-04   8.462  &lt; 2e-16 ***</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si  8.834e-05  9.551e-06   9.249  &lt; 2e-16 ***</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr -1.504e-03  2.441e-03  -0.616  0.53790    </span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti -1.600e-03  4.014e-04  -3.985 6.97e-05 ***</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V  -1.185e-01  2.086e-02  -5.683 1.51e-08 ***</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y  -4.410e-01  5.018e-02  -8.787  &lt; 2e-16 ***</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn -6.085e-03  7.425e-03  -0.819  0.41260    </span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr -4.571e-02  3.796e-03 -12.042  &lt; 2e-16 ***</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 14.26 on 2064 degrees of freedom</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.4641, Adjusted R-squared:  0.4594 </span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 99.29 on 18 and 2064 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ilr</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ ., data = ZV)</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -47.562  -9.078  -0.358   8.418  62.742 </span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -223.4154    14.2208 -15.710  &lt; 2e-16 ***</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Al   18.5426     2.1194   8.749  &lt; 2e-16 ***</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ba    3.5930     1.2708   2.827 0.004737 ** </span></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ca   -2.5107     0.4673  -5.373 8.63e-08 ***</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Cr   -8.7290     0.6947 -12.565  &lt; 2e-16 ***</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Fe    5.0037     1.5984   3.130 0.001770 ** </span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.K   -19.7906     1.4492 -13.656  &lt; 2e-16 ***</span></span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mg    3.0951     0.8380   3.694 0.000227 ***</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Mn   -1.6047     0.7277  -2.205 0.027543 *  </span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Na   -1.9167     0.5118  -3.745 0.000185 ***</span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Nb   -1.6268     1.3269  -1.226 0.220308    </span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.P     8.8136     0.7090  12.431  &lt; 2e-16 ***</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Si   28.9732     0.9602  30.176  &lt; 2e-16 ***</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Sr    2.6650     0.8665   3.076 0.002128 ** </span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Ti   -9.7818     1.9230  -5.087 3.97e-07 ***</span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.V    -5.0838     1.5331  -3.316 0.000929 ***</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Y   -14.1508     1.3789 -10.262  &lt; 2e-16 ***</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zn   -1.1975     0.9104  -1.315 0.188562    </span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Internal.Zr   -4.2939     1.2564  -3.418 0.000644 ***</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 12.95 on 2064 degrees of freedom</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.5581, Adjusted R-squared:  0.5545 </span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 153.4 on 17 and 2065 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
